
<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
  <div id="wrapper" [ngClass]="{'active': showSidebar == false}">
    <div class="fakeLoader"></div>


    <div id="page-wrapper">

      <div class="row page-titles">
        <div class="col-md-5 align-self-center">
          <h3 class="text-themecolor">Missed Punch</h3>
        </div>
        <div class="col-md-7 align-self-center">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a [routerLink]="['/reports']">Approval</a></li>
            <li class="breadcrumb-item active">Missed Punch</li>
          </ol>
        </div>
      </div>



      <div class="container-fluid">
        <div class="row">
            
            <app-common-filter [extraFilters]="addOnFilters" [isSideBar]="isSideBar" (filterChanged)="searchOnFilters($event)"></app-common-filter>
            

          <div class="col-md-12 col-sm-12">
            <div class="card">
              <div class="card-header">
                <div class="row">
                  
                  <div class="col-md-12 col-sm-12 filter-outer-main-box">

                    <div class="row">

                      <div class="col-md-9 col-sm-9">

                        <div class="col-md-4 col-sm-4 padd-0">
                          <input type="text" class="form-control" placeholder="Search"
                            (keyup)="search($event.target.value)" maxlength="200" />
                        </div>

                        <!-- <div class="col-md-2 col-sm-2">
                          <select class="form-control" (change)="changeMonth($event)">
                            <option *ngFor="let ma of monthsArray" [selected]="month==ma.id" [value]="ma.id">
                              {{ma.month}}
                            </option>
                          </select>
                        </div> -->

                        <!-- <div class="col-md-2 col-sm-2">
                          <select class="form-control" (change)="changeYear($event)">
                            <option *ngFor="let ya of yearsArray" [selected]="year==ya" [value]="ya">{{ya}}</option>

                          </select>
                        </div> -->
                        <div class="col-md-3 col-sm-3" style="display: none;">
                          <span style="margin: 10px;font-weight: bold;">Category</span>
                          <select class="form-control" [(ngModel)]="attendanceCategory" (change)="change_att_category()">
                            <!-- <option value="">All</option> -->
                            <!-- <option value="DE">Deviation</option> -->
                            <option value="MP">Missed Punch</option>
                          </select>
                          <!-- <span style="margin: 10px;font-weight: bold;">&nbsp;</span>
                          <a style="font-weight: 500;color: black;border-color: #0e49ed !important;    margin-left: 2rem;"
                            class="btn btn-secondary manage-btn" (click)="get_missed_punch_att()">
                            Search</a> -->
                        </div>
                        <div class="col-md-2 col-sm-2">
                          <span class="form-control"
                            style="font-weight: bold;background-color:white;border-color: white;">Total :
                            {{missed_punch_data.length}}</span>
                        </div>
                      </div>

                      <div class="col-md-3 col-sm-3">
                        
                      </div>


                    </div>



                  </div>

                </div>
              </div>

              <div class="card-body padd-bot-0 padd-top-0">

                <div class="row">
                  <div class="col-md-12 padd-top-0">
                    <div class="table-responsive bulk-attendance-outer-box Reimbursements-outer-box">
                      <p style="color:blue; display:  none;"><span>Note*</span><span style="font-size: 12px; color: #00a4df;"> &nbsp;For
                          bulk actions, please select the items you wish to update and then click the 'Update Marking
                          Status' button to apply the changes.</span></p>
                      <table class="table user-list" style="margin-bottom: 80px;;" #reportTable>
                        <thead style="background: skyblue;">
                          <tr>
                            <!-- <th>
                              <input type="checkbox" name="check_punch_all" (change)="change_check_punch_all($event)">

                            </th> -->
                            <th>#</th>
                            <th>Employee Name</th>
                            <th>Attendance Date</th>
                            <th>Assign Shift</th>
                            <th>Status</th>
                            <th>Intime</th>
                            <th>OutTime</th>
                            <th>Working hrs</th>
                            <th></th>
                            <!-- <th>Action</th> -->
                          </tr>
                        </thead>
                        <tbody>
                          <ng-container *ngFor="let mpd of missed_punch_data; let i = index">
                            <tr>
                              <!-- <td>
                                <input *ngIf="mpd.is_salary_processed!='Y'" type="checkbox" name="check_punch" (change)="change_check_punch($event, i)">
                              </td> -->
                              <td> {{i+1}}</td>
                              <td>{{mpd.emp_name}}
                                <span *ngIf="mpd.orgempcode; else elseBlock">
                                  [{{mpd.orgempcode}}]
                                </span>
                                <ng-template #elseBlock>
                                  [{{mpd.tp_code}}]
                                </ng-template>
                              </td>
                              <td>{{mpd.att_date}}</td>
                              <td>{{mpd.shift_name_and_timing}}</td>
                              <td>
                                {{!mpd.att_catagory_txt ? mpd.attendance_type: mpd.att_catagory_txt}} </td>
                                <td>{{mpd.check_in_time}}</td>
                                <td>{{mpd.check_out_time}}</td>
                              <td>{{mpd.no_of_hours_worked}}</td>
                              <td>
                                <!--
                                   <span *ngIf="mpd.mis_punch_approval_status == 'P' ">
                                    <button class="btn btn-xs btn-success" (click)="approveMissPunchStatus(mpd)">Approve</button>&nbsp;&nbsp;
                                    <button class="btn btn-xs btn-danger" (click)="rejectMissPunchStatus(mpd)">Reject</button>
                                   </span>
                                 -->
                                   <span *ngIf="mpd.mis_punch_approval_status == 'P' ">
   
                                     <div class="dropdown float-right ember-view dropleft">
                                           <a class="dropdown-toggle no-caret text-muted cursor-pointer ember-view"
                                               data-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                               <svg width="25" height="25"
                                                   viewBox="0 0 512 512" class="icon">
                                                   <path
                                                       d="M162 224c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32M256 224c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32M350 224c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32"
                                                       id="Path"></path>
                                                   <path
                                                       d="M256 480c123.712 0 224-100.288 224-224S379.712 32 256 32 32 132.288 32 256s100.288 224 224 224zm0 32C114.615 512 0 397.385 0 256S114.615 0 256 0s256 114.615 256 256-114.615 256-256 256z"
                                                       id="Oval-1"></path>
                                               </svg>
                                           </a>
                                           <ul id="ember924"
                                               class="dropdown-menu ember-view"
                                               aria-labelledby="dropdownMenuButton">
                                               <li class="dropdown-item"
                                               (click)="approveMissPunchStatus(mpd)">
                                                   Approved
                                               </li>
                                               <li class="dropdown-item"
                                               (click)="rejectMissPunchStatus(mpd)">
                                                   Rejected
                                               </li>
                                           </ul>
                                       </div>
                                     <span *ngIf="mpd.mis_punch_approval_status == 'A'" style="text-color:green;">Approved</span>
                                     <span *ngIf="mpd.mis_punch_approval_status == 'R'" style="text-color:red;">Rejected</span>
                                   </span>
                                 </td>
                              <!-- <td>
                                <ng-container *ngIf="mpd?.is_salary_processed != 'Y'">
                                  <a style="cursor :pointer;" (click)="openAttCalendar2(i)"><i class="fa fa-edit"></i></a>

                                  <a (click)="manage_biometric_att_single(mpd.orgempcode, mpd.att_date)"
                                    title="Re-sync the punches if the check-in/out times are not showing."
                                    style="cursor :pointer; margin-left:10px;">
                                    <i *ngIf="mpd.is_biomatric_device_enable=='Y' && mpd.orgempcode"
                                      class="fa fa-refresh" aria-hidden="true"></i>
                                  </a>
                                </ng-container>
                              </td> -->
                            </tr>
                          </ng-container>

                          <tr *ngIf="missed_punch_data.length == 0">
                            <td colspan="100%" style="text-align: center;">No Data Found</td>
                          </tr>

                        </tbody>

                      </table>


                    </div>
                  </div>
                </div>
              </div>

            </div>
            <alert></alert>
          </div>
        </div>
      </div>


    </div>

  </div>

</section>

<app-footer></app-footer>




<div class="modal"  [ngStyle]="{'display':confirmationModal?'block':'none'}">
  <div class="modal-dialog modal-sm ">
      <div class="modal-content " >
          <!-- Modal Header -->
          <div class="modal-header">
                  <h4 class="modal-title">Alert</h4>
                  <button type="button" class="close modal-close-btn" data-dismiss="modal" aria-label="Close"
                      data-bs-dismiss="modal" (click)="closeConfirmModal()">
                      <span aria-hidden="true">&times;</span>
                  </button>
          </div>
          <!-- Modal body -->
          <div class="modal-body">
              <div class="row">
                  <div class="col-md-12" style="min-height:50px;">
                    <p>Are you sure you want to <span *ngIf="approveStatus=='A'">approve</span><span *ngIf="approveStatus=='R'">reject</span> attendance?</p>
                    </div>
              </div>

              <!-- Modal footer -->

              <div class="modal-footer" style="background-color: #fff;">
                <button class="btn btn-success btn-xs"  data-dismiss="modal" (click)="approveOrRejectStatus()">Yes</button>
                <button type="button" class="btn btn-danger btn-xs" data-dismiss="modal" aria-hidden="true" (click)="closeConfirmModal()">No</button>
              </div>


          </div>
      </div>
  </div>
</div>
