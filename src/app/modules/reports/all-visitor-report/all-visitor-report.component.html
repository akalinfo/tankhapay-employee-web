<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
    <div id="wrapper" [ngClass]="{'active': showSidebar == true}">
      <div class="fakeLoader"></div>
  
      <div id="page-wrapper">
        <div class="row page-titles">
        	<div class="col-md-5 align-self-center">
                <h3 class="text-themecolor">All Visitors</h3>
            </div>
          <div class="col-md-7 align-self-center">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a [routerLink]="['/reports']">Reports</a></li>
  
              <li class="breadcrumb-item active">All Visitor</li>
            </ol>
          </div>
        </div>

        <div class="container-fluid">
            <!-- /row -->
            <div class="row">
                <div class="col-md-12 col-sm-12">
                  <form [formGroup]="Datepicker_Form">
                    <div class="card">
                    
                        <div class="card-header">
                        <div class="row">
                        <div class="col-md-2" style="display: flex; align-items: center;">
                           
                           <span style="margin: 1.5rem; font-weight: 500;" class="">Select Date:</span>
                          
                        </div>
                        
                        <div class="col-md-3">
                          <input id="FromDate2" #rd class="form-control" type="text" style="cursor: pointer;"
                            formControlName="FromDate" placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                        </div>

                        <div class="col-md-3">
                          <input id="ToDate2" #rd class="form-control" type="text" style="cursor: pointer;"
                            formControlName="ToDate" placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                        </div>
                        
                        <div class="col-md-2">
                           <button class="btn btn-primary" style=" padding: 10px;" (click)="Visitor_list()">Search</button>
                        </div>
                        
                        <div class="col-md-2">
                          <div class="Show-Fields-top-outer-box">
                            <div class="dropdown float-right-box">
                              <ul class="nav nav-pills" role="tablist">
                                <li role="presentation" class="dropdown">
                                  <a href="#" id="drop6" data-toggle="dropdown" role="button" aria-haspopup="true"
                                    aria-expanded="true" class="dropdown-toggle btn btn-user1 btn-round btn-primary">Export
                                    as <span class="caret"></span></a>
                                  <ul id="menu3" aria-labelledby="drop6" class="dropdown-menu">
                                    <li><a (click)="exportToExcel()" style="cursor: pointer;"> XLSX (Microsoft Excel)</a>
                                    </li>
                                  </ul>
                                </li>
                              </ul>
                            </div>
    
                          </div>
    
                        </div>
                      
                        
                        </div>
                        </div>
                        
                        <div class="card-body">
                            
                            <div class="row">
                        
                        <div class="col-md-12 padd-top-0">
                          <div class="row justify-content-end">
                            <div class="col-md-3 text">
                                <p><strong>Total Visitors: {{ visitor_list_data?.length }}</strong></p>
                            </div>
                            <div class="col-md-3" style="float: right;">
                                <input type="text" formControlName="searchKeyword" placeholder="Search" class="form-control" (keyup)="search($event)" />
                            </div>
                        </div>
                        
                      
                        


                        <div class="table-responsive bulk-attendance-outer-box Reimbursements-outer-box">
            
                        
                            <table class="table user-list">
                               <thead>
                                  <tr>
                                     <th>#</th>
                                     <th>Name</th>
                                     <th>Mobile</th>
                                     <th>Email</th>
                                     <th>Registration Date</th>
                                     <th>Last Check In Time</th>
                                     <th>Last Check Out Time</th>
                                     <th>Card Number</th>
                                  </tr>
                               </thead>
                               <tbody>
                                <ng-container *ngFor="let visitor of filteredEmployees; let i = index">
                                  <tr>
                                    <td>{{i+1}}
                                    </td>

                                  <td >
                                   
                                    <div class="visitor-avatar12 job-img" *ngIf="visitor.identity_details">
                                        <img src="{{ visitor.identity_details }}" (click)="enlargeImage(visitor.identity_details)" alt="Identity Image">
                                    </div>
                                
                                    <div class="Visitor-avatar12 job-img" *ngIf="!visitor.identity_details">
                                        <img src="../../../../assets/img/user-1.jpg"  alt="No Image" class="no-image">
                                    </div>
                                    {{ visitor.visitor_name }} {{ visitor.visitor_last_name }}
                                </td>
                                
                                     <td>{{visitor.visitor_mobile}}</td>
                                     <td>{{visitor.visitor_email}}</td>
                                     <td>{{ formatDate(visitor.createdon) }}</td>
                                     <td>{{visitor.check_in_time}}</td>
                                     <td>{{visitor.check_out_time}}
                                  </td>     
                                  <td>{{visitor.assign_visiting_card1}}</td>
                                  
                                     </tr>
                                </ng-container>
                                  
                               </tbody>
                               
                            </table>
                        
                        </div>


<!-- <div class="col-md-12 text-center" *ngIf="visitor_list_data?.length > 0">
<div class="d-flex justify-content-center align-items-center">
<span> <strong>Rows :</strong></span>&nbsp;&nbsp;
<select class="form-control large-select" class="btn btn-info" type="button" (change)="changePageSize($event.target.value)">
<option *ngFor="let size of pageSizes" [value]="size" [selected]="size === pageSize">{{ size }}</option>
</select>&nbsp;&nbsp;

</div>
</div>  -->


                        </div>
                        
                
                            
                            
                        </div>		
                            
                        </div>
                    </div>
                  </form>
                </div>
            </div>
            <!-- /row -->
        </div>	
      </div>


    </div>
</section>