<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
  <div id="wrapper" [ngClass]="{'active':showSidebar==false}">
    <div class="fakeLoader"></div>

    <div id="page-wrapper">
      <div class="row page-titles">
        <div class="col-md-5 align-self-center">
          <h3 class="text-themecolor">Biometric Punch Logs</h3>
        </div>
        <div class="col-md-7 align-self-center">
          <ol class="breadcrumb">
            <li class="breadcrumb-item" title="Dashboard"><a [routerLink]="['/reports']">Report</a></li>
            <li class="breadcrumb-item active">Biometric Punch Logs </li>
          </ol>
        </div>

      </div>
      <div class="container-fluid">
        <!-- /row -->
        <div class="row">
          <div class="col-md-12 col-sm-12">

            <div class="card filter-outer-main-box" style="z-index: 999;">
              <div class="card-body ">
                <div class="row" style="display: flex; justify-content: flex-end;">

                  <div class="col-md-3 col-sm-3 text-right" style="margin: 7px;">
                    <div class="form-group">
                      <a (click)="openSidebar()" class="btn excel-btn-box results filter-onlick-btn"
                        style="padding-top: 9px;">
                        <span class="filter_count-box"></span>Filters<i class="fa fa-filter" style="margin-left: 5px;"></i>
                      </a>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>

          <div class="col-md-12 col-sm-12">

            <div class="card filter-outer-main-box">
              <div class="card-header">
                <span style="font-size: 12px; font-weight: bold;" *ngIf="last_synced_msg">
                  Last Biometric Punches Synced for Date <b style="color: red;">{{last_synced_msg}}</b>
                  &nbsp;
                  <span style="font-weight: bold;margin-top: 3rem;">
                    Total : {{tot_count}} Record(s)
                  </span>
                </span>

                <div class="col-md-12 ">
                  <div class="row">
                    <form style="margin-top: 1rem;">
                      <div class="col-md-2" style="display:none;">
                        <b>From Date</b>
                        <input id="FromDate1" class="form-control" type="text" style="cursor: pointer;"
                          placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                      </div>
                      <div class="col-md-2" style="display:none;">
                        <b>To Date</b>
                        <input id="ToDate1" class="form-control" type="text" style="cursor: pointer;"
                          placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                      </div>

                      <!--start - search field -->
                      <div class="col-md-3 padd-0">
                        <input type="text" placeholder="Search Employee Code | Name" maxlength="50"
                          class="form-control wide-width" style="width: 100%;" [value]="invKey"
                          (keyup)="search($event)" />
                      </div>
                      <!--end - search field -->

                      <div class="col-md-2" *ngIf="show_process_buttion" style="display: none;">
                        <b> Sync Status</b>
                        <select class="form-control" (change)="filter_SyncStatus($event.target.value)">
                          <option value="">All</option>
                          <option value="Y">Synced</option>
                          <option value="N">Not Synced</option>
                        </select>
                      </div>
                      <div class="col-md-2" *ngIf="show_process_buttion" style="display: none;">
                        <b>Link Status (TP)</b>
                        <select class="form-control" (change)="filter_LinkStatus($event.target.value)">
                          <option value="">All</option>
                          <option value="Y">Linked</option>
                          <option value="N">Not Linked</option>
                        </select>
                      </div>
                    </form>

                    <div class="col-md-1 padd-0">
                      <a class="btn excel-btn-box results btn-primary" style="padding: 9px;border-radius: 0px;"
                        (click)="getPunching_Attendance(0)">
                        <i class="fa fa-search" aria-hidden="true"></i>
                      </a>
                    </div>
                    
                    <div class="col-md-3 col-sm-3" *ngIf="show_process_buttion">
                      <button class="btn btn-success" (click)="synced_punches()" style="height: 40px;text-align: left;">
                        Sync Check-in/Check-out<i class="fa fa-upload" style="margin-left: 7px;"></i>
                      </button>
                    </div>

                    <div class="col-md-4 padd-0" style="float: right;margin-right: 20px;">
                      <div class="Show-Fields-top-outer-box" style="margin-left: 10px;">
                        <div class="dropdown float-right-box">
                          <a class="btn btn-round btn-success excel-btn-box" style="padding-top: 9px;"
                            (click)="exportToExcel()">&nbsp;<i class="fa fa-file-excel-o" aria-hidden="true"></i></a>
                        </div>
                      </div>
                    </div>
                    <!-- <div class="col-md-3">
                      <b>&nbsp;<br></b>
                      <span style="font-weight: bold;margin-top: 3rem;"> <b> &nbsp;</b> Total :
                        {{tot_count}}
                        Record(s)</span>

                    </div> -->
                    <!-- </div>
                </div>

                <div class="col-lg-12">
                  <div class="row"> -->

                  </div>
                </div>

              </div>

              <div class="card-body">
                <div style="display: flex;justify-content: end;">
                  <div class="col-md-3 col-sm-3" *ngIf="is_show_gallops_btn" style="margin: 10px;">
                    <button class="btn btn-info btn-sm" (click)="redirect_to_sync_attendace()" style="float: right;">
                      Fetch Gallops Attendance
                    </button>
                  </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <div class="table-responsive reports-table-outer-box reports-new-table-outer-box">
                    <table class="table table-striped table-bordered">
              
                      <thead style="background: skyblue;">
                        <tr>
                          <th>#</th>
                          <th>Att txn Id</th>
                          <th>Employee Code(ORG)</th>
                          <th>Employee Name</th>
                          <th>Designation</th>
                          <th>Punch Date</th>
                          <th>Punch Time</th>
                          <th>Device Serial No</th>
                          <th>Synced Status</th>
                          <th>In/Out</th>
                        </tr>
                      </thead>
              
                      <tbody style="background: aliceblue;">
                        <ng-container
                          *ngFor="let report of filteredEmployees | paginate:{itemsPerPage:page_size,currentPage: p+1,totalItems:tot_count}let i=index; ">
                          <tr [ngClass]="{'light-skyblue': i % 2 == 0, 'white': i % 2 != 0}">
                            {{(p)*page_size+(i+1)}}
                            <td>{{report.att_txn_id}}</td>
                            <td>{{report.emp_code_org}}</td>
                            <td>{{report.emp_name}} <span *ngIf="report.dateofjoining" style="font-size: 12px;">|
                                {{report.dateofjoining}}</span></td>
                            <td>{{report.post_offered}}</td>
                            <td>{{report.punch_date}} </td>
                            <td>{{report.punch_time}} </td>
                            <td>{{report.machine_serial_no}}</td>
                            <td>
                              {{report.is_processed}} &nbsp;
                              <a (click)="manage_biometric_att(report.emp_code_org)"
                                title="Re-sync the punches if the check-in/out times are not showing." *ngIf="show_process_buttion"
                                style="cursor :pointer;">
                                <i *ngIf="report.is_processed=='Y' && report.emp_code_org" class="fa fa-refresh"
                                  aria-hidden="true"></i>
                              </a>
                            </td>
                            <td>{{report.txn_punch_type}}</td>
                          </tr>
                        </ng-container>
                      </tbody>
                    </table>
              
                    <div class="flexbox padd-10 pagination-outer-box" *ngIf="filteredEmployees.length > 0">
                      <pagination-controls (pageChange)="getPage($event)" maxSize="9" directionLinks="true" autoHide="true"
                        responsive="true" previousLabel="Prev" nextLabel="Next" screenReaderPaginationLabel="Pagination"
                        screenReaderPageLabel="page" screenReaderCurrentLabel="You're on page"
                        style="font-size: 2rem;padding: 6px;font-weight: bold" class="float-right"></pagination-controls>
                    </div>
              
                    <alert></alert>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>

  </div>
</section>
<app-footer></app-footer>



<!---SideBar--->
<div id="sidebar" class="sidebar bg-dark text-white sidebar-menu_filter-box">
  <h3 class="filter-menu-header-text-box">Filter</h3>
  <!-- <button type="button" class="btn btn-user1 btn-round" (click)="resetFilter()">Clear</button>-->
  <a class="clear-box-btn" title="Clear Filter" (click)="resetFilter()">Clear</a>
  <button class="close-btn btn btn-danger1" (click)="closeSidebar()"><i class="fa fa-close"></i></button>
  <div class="sidebar-content-box">

    <div class="col-md-12 col-sm-12">
      <input type="text" [(ngModel)]="invKey_copy" placeholder="Search Employee Code | Name" maxlength="50"
        class="form-control wide-width" style="width: 100%;" maxlength="200">
    </div>

    <div class="col-md-12 ">

      <div id="filterComponent">
        <div class="panel-group">

          <div class="panel panel-default">
            <div class="panel-heading panel_heading_gray  card-header" role="tab" id="headingOne2"
              data-toggle="collapse" data-parent="#accordion2" href="#collapseOne2" aria-expanded="false"
              aria-controls="collapseOne">
              <h4>Biometric Punch Filter <i class="fa fa-angle-down"></i></h4>
            </div>
            <div id="collapseOne2" class="panel-collapse collapse card-body in" role="tabpane2">
              <div class="row">
                <div class="col-sm-12">


                  <div class="col-md-6">
                    <span style="color:#000;">From Date</span>
                    <input id="FromDate" class="form-control" type="text" style="cursor: pointer;"
                      placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                  </div>
                  <div class="col-md-6">
                    <span style="color:#000;">To Date</span>
                    <input id="ToDate" class="form-control" type="text" style="cursor: pointer;"
                      placeholder="dd-mm-yyyy" autocomplete="off" readonly>
                  </div>


                  <div class="form-group" *ngIf="show_process_buttion">
                    <label class="control-label col-sm-12">Sync Status</label>
                    <div class="col-sm-12 padd-0">
                      <select class="form-control" [(ngModel)]="filter_SyncStatus_val_copy">
                        <option value="">All</option>
                        <option value="Y">Synced</option>
                        <option value="N">Not Synced</option>
                      </select>
                    </div>
                  </div>


                  <div class="form-group" *ngIf="show_process_buttion">
                    <label class="control-label col-sm-12">Link Status (TP)</label>
                    <div class="col-sm-12 padd-0">
                      <select class="form-control" [(ngModel)]="filter_LinkStatus_val_copy">
                        <option value="">All</option>
                        <option value="Y">Linked</option>
                        <option value="N">Not Linked</option>
                      </select>
                    </div>
                  </div>


                  <!-- <div class="form-group">
                    <label class="control-label col-sm-12">Organization Unit</label>
                    <div class="col-sm-12 padd-0 userOrgUnit">

                      <ng-multiselect-dropdown [placeholder]="'Select Organization Units'" [settings]="dropdownSettings"
                        [data]="orgList" [(ngModel)]="orgName_copy" [ngModelOptions]="{standalone: true}"
                        (onSelect)="change_OrgUnit_Dept_Sidebar()" (onDeSelect)="change_OrgUnit_Dept_Sidebar()">
                      </ng-multiselect-dropdown>

                    </div>
                  </div>

                  <div class="form-group">
                    <label class="control-label col-sm-12">Department</label>
                    <div class="col-sm-12 padd-0 userOrgUnit">

                      <ng-multiselect-dropdown [placeholder]="'Select Department'" [settings]="deptDropdownSettings"
                        [data]="deptList" [(ngModel)]="deptName_copy" [ngModelOptions]="{standalone: true}"
                        (onSelect)="change_OrgUnit_Dept_Sidebar()" (onDeSelect)="change_OrgUnit_Dept_Sidebar()">
                      </ng-multiselect-dropdown>

                    </div>
                  </div>

                  <div class="form-group">
                    <label class="control-label col-sm-12">Designation</label>
                    <div class="col-sm-12 padd-0 userOrgUnit">

                      <ng-multiselect-dropdown [placeholder]="'Select Designation'" [settings]="desgDropdownSettings"
                        [data]="desgList" [(ngModel)]="desgName_copy" [ngModelOptions]="{standalone: true}">
                      </ng-multiselect-dropdown>
                    </div>
                  </div> -->



                </div>

              </div>
            </div>
          </div>



        </div>
      </div>

      <div class="text-center mrg-bot-25">
        <button type="button" class="btn btn-user1 btn-round btn-primary" (click)="change_sidebar_filter()"
          id="btnSetFilter">
          &nbsp;Apply</button>

      </div>
    </div>
  </div>
</div>
<!---SideBar--->