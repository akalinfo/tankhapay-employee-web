<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
    <div id="wrapper" [ngClass]="{'active': showSidebar == false}">
        <div class="fakeLoader"></div>


        <div id="page-wrapper">
            <div class="container">
                <div class="row">
                    <div class="row page-titles">
                        <div class="col-md-5 align-self-center">
                            <h3 class="text-themecolor">Employee Pay Summary Report</h3>
                        </div>
                        <div class="col-md-7 align-self-center">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a [routerLink]="['/reports']">Reports</a></li>
                                <li class="breadcrumb-item active">Employee Pay Summary Report</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <app-common-filter [filters]="filters" [isSideBar]="isSideBar"
                    (filterChanged)="applyFilters($event)"></app-common-filter>
            
                    <div class="col-md-12 col-sm-12 filter-outer-main-box">
                        <div class="card">
                            <div class="card-header">
                                <div class="row">

                                    <div class="col-md-4">
                                        <!-- <input type="text" value="" placeholder="Search Employee(s)"
                                          class="form-control wide-width" style="width: 100%;"
                                          (keyup)="search($event)" /> -->
                                    </div>

                                    <div class="col-md-4"></div>

                                    <div class="col-md-4">
                                            <div class="dropdown float-right-box">
                                                <ul class="nav nav-pills" role="tablist">
                                                    <li role="presentation" class="dropdown">
                                                        <a href="javascript:void();"
                                                            class="dropdown-toggle btn btn-primary" 
                                                            data-toggle="dropdown">Download
                                                            <span class="caret"></span>
                                                        </a>
                                                        <ul class="dropdown-menu" style="position: absolute;">
                                                            <li><a 
                                                                (click)="downloadSelectedSlips('N')">
                                                                Payslip</a>
                                                            </li>
                                                            <li><a 
                                                                (click)="downloadSelectedSlips('Y')">
                                                                Advance Payslip</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </div>
                                            <!-- <input id="downloadSalSlip" type="submit"
                                                title="Select Employee and Download Salary Slip"
                                                class="dropdown-toggle btn btn-user1 btn-round btn-primary"
                                                value="Download" (click)="downloadSelectedSlips()"
                                                [disabled]="!isButtonEnabled"> -->

                                            <!-- <ul class="nav nav-pills" role="tablist">
                                                <li role="presentation" class="dropdown open">
                                                    <a href="#" id="drop6" data-toggle="dropdown" role="button"
                                                        aria-haspopup="true" aria-expanded="true"
                                                        class="dropdown-toggle btn btn-user1 btn-round btn-primary">Export
                                                        as <span class="caret"></span></a>
                                                    <ul id="menu3" aria-labelledby="drop6" class="dropdown-menu">
                                                        <li><a (click)="exportToExcel()" style="cursor: pointer;"> XLSX
                                                                (Microsoft Excel)</a></li>
                                                    </ul>
                                                </li>
                                            </ul> -->

                                    </div>


                                </div>

                            </div>



                            <div class="card-body">

                                <div class="col-lg-12 col-md-12 col-sm-12">
                                    <div class="table-responsive reports-table-outer-box reports-new-table-outer-box reports-main-outerbox-table">
                                        <table class="table table-striped table-bordered">
                                            <thead style="background: skyblue;">
                                                <tr>
                                                    <th>#</th>
                                                    <th><input type="checkbox"
                                                            style="transform: scale(1.2);float: right;"
                                                            (change)="checkAll($event)"> </th>
                                                    <!-- <th scope="col" >Advance Salary Slip</th> -->
                                                    <th>TP / Org Emp Code</th>
                                                    <th>Employee Name</th>
                                                    <!-- <th>Org Empcode</th>
                                                    <th>Tp Code</th> -->
                                                    <th>Salary Month</th>
                                                    <th >Department</th>
                                                    <th >Designation</th>
                                                    <th >Job Type</th>
                                                    <th >Unit Parameter Name</th>
                                                    <th *ngIf="showPaymentStatusColumn">Payment Status </th>
                                                    <th style="width:102px;">Action</th>
                                                    <!-- <th>Advance Salary</th> -->
                                                    <th *ngIf="isConsultantEmployee">Independent Contractors Invoice</th>
                                                </tr>
                                            </thead>

                                            <!-- "showfields['updated_on']" -->
                                            <tbody style="background: aliceblue;">
                                                <ng-container *ngFor="let report of filteredEmployees;let i=index;">
                                                    <tr [ngClass]="{'light-skyblue': i % 2 == 0, 'white': i % 2 != 0}">
                                                        <td>{{i+1}}</td>
                                                        <td><input type="checkbox"
                                                                style="transform: scale(1.2);float: right;"
                                                                [(ngModel)]="report.isSelected"
                                                                [disabled]="report.jobtype === 'Independent Contractors'"
                                                                (change)="updateButtonState()">
                                                            &nbsp;</td>


                                                        <!-- <td *ngIf="includeEmployeeDetails"></td> -->
                                                        <td>
                                                            {{ (report.orgempcode !== '' && report.orgempcode != null && report.orgempcode != undefined) ? report.orgempcode : report.tpcode }}
                                                          </td>
                                                          
                                                        <td>
                                                        {{report.emp_name}}
                                                        <div><strong>{{report.email}}</strong></div>
                                                        </td>
                                                        <!-- <td>{{report.orgempcode}}</td>
                                                        <td>{{report.tpcode}}</td> -->
                                                        <td>{{report.sal_month_year}}</td>
                                                        <td >{{report.posting_department}}</td>
                                                        <td >{{report.designation}}</td>
                                                        <td >{{report.jobtype}}</td>
                                                        <td >{{report.unitparametername}}</td>
                                                        <td *ngIf="showPaymentStatusColumn">
                                                            <span class="paid-color-btn">Paid On {{ parseDateTime(report.downloaddatetime) | date:'dd/MM/yyyy' }}</span> 
                                                        </td>                                                        
                                                        <td style="text-align: center;">
                                                            
                                                            <!-- <a class="view-salary-slip" target="_blank"
                                                                title="Click to View and Download Payslip"
                                                                (click)="getSalaryDetail(report)"
                                                                *ngIf="report.jobType!='Consultant'"
                                                                [ngClass]="{'disabled': report.jobtype === 'Consultant'}"
                                                                [attr.aria-disabled]="report.jobtype === 'Consultant' ? 'true' : null">
                                                                <i class="fa fa-eye" aria-hidden="true"></i>
                                                            </a> -->

                                                            <div class="dropdown float-right-box" *ngIf="report.jobType!='Independent Contractors'">
                                                                <ul class="nav nav-pills" role="tablist">
                                                                    <li role="presentation" class="dropdown">
                                                                        <a href="javascript:void();"
                                                                            class="dropdown-toggle"
                                                                            data-toggle="dropdown"><i class="fa fa-eye" aria-hidden="true"></i>
                                                                            <!-- <span class="caret"></span> -->
                                                                        </a>
                                                                        <ul class="dropdown-menu" style="position: absolute;">
                                                                            <li><a 
                                                                                (click)="getSalaryDetail(report,'N')"
                                                                                [ngClass]="{'disabled': report.jobtype === 'Independent Contractors'}"
                                                                                [attr.aria-disabled]="report.jobtype === 'Independent Contractors' ? 'true' : null">
                                                                                Payslip</a>
                                                                            </li>
                                                                            <li><a 
                                                                                (click)="get_advance_SalaryDetail(report,'Y')"
                                                                                [ngClass]="{'disabled': report.jobtype === 'Independent Contractors'}"
                                                                                [attr.aria-disabled]="report.jobtype === 'Independent Contractors' ? 'true' : null">
                                                                                Advance Payslip</a>
                                                                            </li>
                                                                        </ul>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            <a style="padding: 10px 15px;position: relative;top: 11px;cursor: pointer;"
                                                            title="Send mail" (click)="sendMail(report)"><i class="fa fa-paper-plane" aria-hidden="true"></i></a>
                                                        </td>
                                                        <!-- <td style="text-align: center;">
                                                            <a class="view-salary-slip" target="_blank"
                                                                title="Click to View and Download Advance Payslip"
                                                                (click)="get_advance_SalaryDetail(report)"
                                                                *ngIf="report.jobType!='Consultant'"
                                                                [ngClass]="{'disabled': report.jobtype === 'Consultant'}"
                                                                [attr.aria-disabled]="report.jobtype === 'Consultant' ? 'true' : null">
                                                                <i class="fa fa-eye" aria-hidden="true"></i></a>
                                                            
                                                        </td> -->
                                                        <td *ngIf="isConsultantEmployee" style="text-align: center;">
                                                            <a target="_blank" class="view-salary-slip"
                                                            title="Click to View and Download Independent Contractors Invoice"
                                                            *ngIf="report.jobtype==='Independent Contractors'"
                                                            (click)="get_consultant_invoice(report)"><i class="fa fa-eye" aria-hidden="true"></i></a>
                                                        </td>
                                                    </tr>
                                                </ng-container>
                                            </tbody>
                                        </table>
                                        <alert></alert>
                                    </div>

                                </div>

                                <!-- <div class="flexbox padd-10" *ngIf="filteredEmployees.length > limit">
                                    <pagination-controls (pageChange)="get_page($event)"
                                        style="font-size: 2rem; padding: 6px; font-weight: bold"
                                        class="float-right"></pagination-controls>
                                </div> -->

                                <!-- <button (click)="downloadSelectedSlips()" [disabled]="selectedCount <= 1">Download Selected Slips</button> -->
                                <!-- <div class="col-sm-12 text-center">
                                    <input id="downloadSalSlip" type="submit" class="btn btn-success btn-lg" value="Preview &amp; Download Salary Slip" (click)="downloadSelectedSlips()"  [disabled]="!isButtonEnabled">                       
                                </div> -->
                            </div>
                            <!-- <div class="col-lg-12 col-md-12 col-sm-12">
                                <div *ngIf=" data.length == 0 && !show_label" class="alert alert-danger text-center">
                                    No Record Found.
                                </div>

                                <div *ngIf=" data.length == 0 && show_label" class="alert alert-success text-center">
                                    Please filter to view records.
                                </div>

                            </div> -->
                        </div>
                    </div>
                </div>



            </div>



        </div>
        <!-- <app-toastr></app-toastr> -->
    </div>
</section>

<div
  [@grooveState]="isShowSalary?'active':'inactive'" 
  class="modal fade add-address-form-box Component-outer-box in"
>
  <div class="modal-dialog modal-lg" [@dongleState]="isShowSalary?'active':'inactive'"
  style="width:90%;">
    <div class="modal-content">
        <div class="modal-header theme-bg">
          <h4 class="modal-title">View Salary Slip</h4>
          <button
            type="button"
            class="close"
            (click)="hideSalarySlip()"
            aria-hidden="true"
          >
            x
          </button>
        </div>
        <div class="modal-body card-body">
          <div class="card">
            <div class="card-body">

                <iframe [src]="pdfUrl" width="100%" height="600px" *ngIf="pdfUrl"></iframe>
                 <!-- Display message if URL is null -->
                <div *ngIf="!pdfUrl" class="no-salary-slip">
                    <div class="alert alert-warning text-center">
                    <h5><i class="fa fa-info-circle" aria-hidden="true"></i> Salary Slip Not Generated</h5>
                    <p>Your salary slip has not been generated yet. Please check back later or contact HR for assistance.</p>
                    </div>
                </div>
                <div class="col-md-12" style="text-align:center">
                    <button class="btn btn-danger" (click)="hideSalarySlip()">Close</button>
                </div>
            </div>
          </div>
        </div>
    </div>
  </div>
</div>
<app-footer></app-footer>
