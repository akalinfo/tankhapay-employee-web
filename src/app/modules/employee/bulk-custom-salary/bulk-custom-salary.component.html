<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
    <div id="wrapper" [ngClass]="{'active': showSidebar==false}">
        <div class="fakeLoader"></div>
        <!-- Navigation -->

        <!-- Sidebar Navigation -->
  
        <div id="page-wrapper">
            <div class="row page-titles">
                <div class="col-md-5 align-self-center">
                    <h3 class="text-themecolor">Bulk Custom Salary </h3>
                </div>
                <div class="col-md-7 align-self-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item" title="Home"><a [routerLink]="['/employees']">Employees</a></li>
                        <li class="breadcrumb-item active">Bulk Custom Salary</li>
                    </ol>
                </div>
            </div>

              
            <div class="container-fluid">
                <!-- /row -->
                <div class="row">


                    <div class="col-md-12 mrg-top-25 mrg-bot-25">

                        <!-- General Information -->
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-12" >
                                        <div class="col-md-12" *ngIf="excelToTableData.length==0">

                                            <h3>Bulk Salary Employee(s)</h3>
                                            <ul style="padding-left:10px;">
                                                <!-- (click)="exportToExcel()" -->
                                                <li>1. Please download our
                                                    <a (click)="toggleDropdown($event)" style="cursor: pointer;" target="_blank" title="Download Bulk Salary Employees sample file">template</a> for Bulk Salary Employees

                                                    <div class="subdropdown-menu" *ngIf="showDropdown">
                                                        <ul>
                                                            <li (click)="exportToExcel('Onboarding Pending')">
                                                                <i class="icon-onboarding"></i> Onboard Employees
                                                            </li>
                                                            <li (click)="exportToExcel('Active')">
                                                                <i class="icon-active"></i> Active Employees
                                                            </li>
                                                        </ul>
                                                    </div>

                                                </li>
                                                <li>2. Edit this file in Excel, and add all your employees salary details.
                                                </li>
                                                <li>3. Save and upload this file below. Any other file will be rejected.
                                                </li>
                                                <!-- <li>4. Salary updates performed here will be effective from 1st of the current month, to add a custom effective date please use <a href="javascript:void()">bulk salary revision</a>.</li> -->
                                            </ul>
                                                
                                            <h3 class="mrg-top-15" >Template file instructions -</h3>

                                            <ul style="padding-left:10px ;">
                                                <li style="color: red;">1. Please do not add/remove columns & do not change any column names.</li>
                                                <li style="color: red;">2. Please ensure that the date values in this column are prefixed with an apostrophe ('). Do not remove the apostrophe (').
                                                    Make sure that the date format should be [DD/MM/YYYY].
                                                </li>
                                                <li style="color: red;">3. If there is no data for a particular cell, leave it empty. Don't enter "-", "NA", etc.
                                                </li>
                                                <li style="color: red;">4. Please enter Y for Yes and N for No.</li>                                            
                                                <li>5. <span class="" style="font-weight: bold;"> Note .</span><span
                                                    style="font-weight: 200;"> 
                                                   <p> <b>Formulas Used </b>
                                                    <br>
                                                   <strong> Gross Salary </strong>=  basic+ hra +   allowances + conveyance_allowance +  medical_allowance + commission + salarybonus + transport_allowance + travelling_allowance + leave_encashment + overtime_allowance + notice_pay + hold_salary_non_taxable + children_education_allowance + gratuityinhand
                                                    
                                                    <br>
                                                    <strong>Net Pay (salary_in_hand) </strong> = gross - epf_employee - esi_employee-    gratuity - employeeinsuranceamount
                                                    <br>
                                                    
                                                  <strong> Cost To Company (CTC) </strong>  = gross + epf_employer + esi_employer + employerinsuranceamount + employergratuity
                                                </p>. </span>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="file" 
                                                accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                                                name="employee_doc" class="allowed_jpg_jpeg_pdf form-control"
                                                id="salary_input" (change)="onFileChange($event)">
                                                
                                        </div>
                                        <div class="col-sm-6"  *ngIf="excelToTableData?.length!=0">
                                            <span style="float: left;cursor:pointer;" (click)="clearInput()" title="Clear"><a><i
                                                        class="fa fa-lg fa-refresh"></i></a></span>
                                                        <!-- <a  class="btn btn-danger" style="float: right;cursor:pointer;" 
                                                        (click)="removeErrorRecords()">Remove error record</a> -->
                                        </div>

                                        <div class="col-md-12" *ngIf="excelToTableData.length>0">
                                            <div class="card">
                                                <div class="card-body" style="overflow:auto;" id="style-2">
                                                    <table class="table table-bordered" *ngIf="!isSalaryCalculated || apiErrors[0]">
                                                        <thead>
                                                            <tr>
                                                                <th>#</th>
                                                                <th *ngIf="isApiError.length>0" style="width: 20%;">Status</th>
                                                                <th>Employee Name</th>
                                                                <th>Org Emp code</th>
                                                                <th>TP code</th>
                                                                <th>Monthly Offered Package</th>
                                                                <th>Basic</th>
                                                                <th>HRA</th>
                                                                <th>Allowances</th>
                                                                <th>Conveyance Allowance</th>
                                                                <th>Medical Allowance</th>
                                                                <th>Commission</th>
                                                                <th>Salary Bonus</th>
                                                                <th>Transport Allowance</th>
                                                                <th>Travelling Allowance</th>
                                                                <th>Leave Encashment</th>
                                                                <th>Overtime Allowance</th>
                                                                <th>Notice Pay</th>
                                                                <th>Hold Salary Non Taxable</th>
                                                                <th>Children Education Allowance</th>
                                                                <th>Gratuity In Hand</th>
                                                                <th>Gross</th>
                                                                <th>PF Cap Applied</th>
                                                                <th>EDLI Admin Charges Include in CTC</th>
                                                                <th>EPF Employer</th>
                                                                <th>EPF Employee</th>
                                                                <th>ESI Employer</th>
                                                                <th>ESI Employee</th>
                                                                <th>Salary in Hand</th>
                                                                <th>CTC</th>
                                                                <th>Salary Days Opted</th>
                                                                <th>Salary Days</th>
                                                                <th>LWF Applicable</th>
                                                                <th>Professional Tax Applicable</th>
                                                                <th>Location Type</th>
                                                                <th>Min Wages State Name</th>
                                                                <th>Effective Date</th>
                                                                <th>Date of Joining</th>
                                                                <th>Gratuity</th>
                                                                <th>PF Applicable Components</th>
                                                                <th>ESI Applied Components</th>
                                                                <th>Is Group Insurance</th>
                                                                <th>Employee Insurance Amount</th>
                                                                <th>Employer Insurance Amount</th>
                                                                <th>Employer Gratuity</th>
                                                                <th>is Hourly Setup</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr *ngFor="let row of excelToTableData;let i=index;">
                                                                <td>{{i+1}}</td>
                                                                <td *ngIf="isApiError.length>0"
                                                                    [ngStyle]="{color:isApiError[i] && !isApiError[i].status ? 'red': ''}">{{isApiError[i].msg}}</td>
                                                                <td *ngFor="let column of displayedColumns"
                                                                [ngStyle]="{color:isApiError[i] && !isApiError[i].status ? 'red': ''}">{{ row[column] }}</td>
                                                              </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>

                                        </div>

                                        <div class="col-md-12 col-12 padd-top-20 text-center" *ngIf="excelToTableData?.length!=0">
                                            <div class="col-md-3" style="text-align: left;">    
                                                <a class="btn btn-primary" (click)="saveBulkCustomSalary()" *ngIf="excelToTableData.length>0">Upload</a>
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
