<app-sidebar (toggleEmitter)="toggle()"></app-sidebar>
<section>
    <div id="wrapper" [ngClass]="{'active': showSidebar == false}">
        <div class="fakeLoader"></div>


        <div id="page-wrapper">

            <div class="row page-titles">
                <div class="col-md-5 align-self-center">
                    <h3 class="text-themecolor">TDS Report</h3>
                </div>
                <div class="col-md-7 align-self-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a [routerLink]="['/reports']">Reports</a></li>
                        <li class="breadcrumb-item active">TDS Report</li>
                    </ol>
                </div>
            </div>

            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="card">
                                <div class="col-md-12">
                                    <form class="tdsForm" [formGroup]="form" (ngSubmit)="generateReport()">
                                        <div class="row" style="margin: 0px;">
                                            <div class="col-md-2">
                                                <label class="form-label">Financial Year</label>
                                                <select class="form-control" formControlName="financialYears">
                                                    <option value="">Financial Year</option>
                                                <option *ngFor="let year of financialYears" [value]="year">{{ year }}</option>
                                                </select>
                                            </div>
                                            <!-- Report Type -->
                                            <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="reportType" class="form-label">Report Type</label>
                                                <select id="reportType" formControlName="reportType" class="form-control">
                                                <option value="">Select Report Type</option>
                                                <option *ngFor="let type of reportTypes" [value]="type.value">
                                                    {{ type.label }}
                                                </option>
                                                </select>
                                            </div>
                                            </div>

                                            <!-- Period -->
                                            <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="period" class="form-label">Period</label>
                                                <select id="period" formControlName="period" class="form-control"  [ngStyle]="{'pointer-events': (this.form.value.reportType == 'Annually')?'none':''}">
                                                <option value="">Select Period</option>
                                                <option *ngFor="let period of periods" [value]="period.value">
                                                    {{ period.label }}
                                                </option>
                                                </select>
                                            </div>
                                            </div>
                                            

                                            <!-- Submit Button -->
                                            <div class="col-md-2">
                                                <div class="form-group w-100" style="margin-top: 26px;">
                                                    <button type="submit" class="btn btn-primary w-100" [disabled]="form.invalid">
                                                    Filter
                                                    </button>
                                                </div>
                                            </div>

                                           

                                             <div class="col-md-2">
                                                <span *ngIf="tdsData.length > 0" style="top: 25px;position: relative;">
                                                    <span class="btn btn-info" (click)="exportToExcelTable()" style="font-size: 13px !important;padding: 8px 13px !important;background-color: #ffffff;color: #1194f7 !important;border: 1px solid #1194f7;margin: 0; border-radius: 5px;"> Export Excel &nbsp;&nbsp;<i
                                                            class="fa fa-file-excel-o"></i>
                                                    </span>
                                                </span>
                                            </div>

                                        </div>
                                        </form>

                                    
                                </div>
                        

                            <div class="table-container" style="margin-bottom: 50px;">
                                        <div style="overflow-x:auto">
                                            <table class="table table-striped table-bordered" id="reportTable" #reportTable style="width: 97%;
    margin-left: 12px;">
                                                <thead>
                                                    <tr>
                                                    <th>Org Emp Code</th>
                                                    <th>Employee Name</th>
                                                    <th>Department</th>
                                                    <th>Designation</th>
                                                    <th>Org Unit Name</th>
                                                    <th>Gross Earning</th>
                                                    <th>Tax Deducted</th>
                                                    <th>Tds Section</th>
                                                    </tr>
                                                </thead>
                                                <tbody *ngIf="tdsData.length >0">
                                                    <tr *ngFor="let report of tdsData">
                                                        <td><span>{{ report.orgempcode || report.tpcode }}</span></td>
                                                        <td>{{ report.emp_name }}</td>
                                                        <td>{{ report.department }}</td>
                                                        <td>{{ report.designation }}</td>
                                                        <td>{{ report.orgunitname }}</td>
                                                        <td>{{ report.grossearning | currency:'INR' }}</td>
                                                        <td>{{ report.taxdeducted | currency:'INR' }}</td>
                                                        <td>{{ report.tds_section | currency:'INR' }}</td>
                                                    </tr>
                                                </tbody>
                                                <tbody *ngIf="tdsData.length == 0">
                                                    <tr>
                                                        <td colspan="8">No Data Available</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>

                                        <div *ngIf="(reportData$ | async)?.length" class="download-buttons">
                                            <button class="btn btn-primary" (click)="downloadReport('pdf')">Download
                                                PDF</button>
                                            <button class="btn btn-primary" (click)="downloadReport('excel')">Download
                                                Excel</button>
                                        </div>
                                    </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<app-footer></app-footer>